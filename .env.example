################################################################################
# N8N INFRASTRUCTURE - EXAMPLE CONFIGURATION FILE
################################################################################
# This file contains all environment variables needed to run
# the complete N8N infrastructure with Evolution API, PostgreSQL and Redis.
# 
# To use this file:
# 1. Copy this file to .env: cp env.example .env
# 2. Configure the values according to your needs
# 3. Run: docker-compose up -d
################################################################################

################################################################################
# ENV
################################################################################
ENV=dev

################################################################################
# GENERAL
################################################################################
# Default timezone
GENERIC_TIMEZONE=America/Sao_Paulo

################################################################################
# REDIS
################################################################################
# REDIS SETUP
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD='your_redis_password_here'

################################################################################
# POSTGRES
################################################################################
# POSTGRES SETUP
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=postgres
POSTGRES_PASSWORD='your_postgres_password_here'
POSTGRES_USER=postgres

################################################################################
#  N8N
################################################################################
N8N_VERSION=1.112.4

# GENERAL N8N
N8N_PROTOCOL=http
N8N_HOST=localhost
N8N_PATH=
N8N_PORT=5678

# KEY (GENERATE YOUR KEY)
N8N_ENCRYPTION_KEY='your_encryption_key_here_minimum_32_characters'

# DIAGNOSTICS
N8N_DIAGNOSTICS_ENABLED=false
N8N_HIRING_BANNER_ENABLED=true

# EXECUTION
N8N_EXECUTIONS_MODE=queue
EXECUTIONS_DATA_MAX_AGE=168
EXECUTIONS_DATA_PRUNE_HARD_DELETE_INTERVAL=24
EXECUTIONS_DATA_PRUNE_SOFT_DELETE_INTERVAL=24
N8N_RUNNERS_ENABLED=true

# DATABASE N8N
N8N_POSTGRES_DB=${POSTGRES_DB}
N8N_POSTGRES_HOST=postgres
N8N_POSTGRES_PORT=5432
N8N_POSTGRES_USER=${POSTGRES_USER}
N8N_POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
N8N_POSTGRES_SCHEMA=public
N8N_DB_TYPE=postgresdb

# LOGGING CONFIGURATION
N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=console
N8N_LOG_FORMAT=text

N8N_REDIS_HOST=redis
N8N_REDIS_PORT=6379
N8N_REDIS_PASSWORD=${REDIS_PASSWORD}

N8N_BLOCK_ENV_ACCESS_IN_NODE=false

# PERMISSIONS
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
N8N_SECURE_COOKIE=false

################################################################################
# EVOLUTION API
################################################################################
# GENERAL
EVOLUTION_PORT=8080
EVOLUTION_URL=http://localhost:8080
EVOLUTION_KEY='your_evolution_api_key_here'
EVOLUTION_LOG_LEVEL=ERROR,WARN,DEBUG,INFO,LOG,VERBOSE,DARK,WEBHOOKS
EVOLUTION_LOG_BAILEYS=error
EVOLUTION_TELEMETRY=false

# Database Setup
EVOLUTION_DATABASE_ENABLED=true
EVOLUTION_DATABASE_CONNECTION_CLIENT_NAME=evolution_exchange
EVOLUTION_DATABASE_PROVIDER=postgresql
EVOLUTION_DATABASE_CONNECTION_URI=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}/${POSTGRES_DB}?schema=public

EVOLUTION_DATABASE_SAVE_DATA_INSTANCE=true
EVOLUTION_DATABASE_SAVE_DATA_NEW_MESSAGE=false
EVOLUTION_DATABASE_SAVE_MESSAGE_UPDATE=false
EVOLUTION_DATABASE_SAVE_DATA_CONTACTS=false
EVOLUTION_DATABASE_SAVE_DATA_CHATS=false
EVOLUTION_DATABASE_SAVE_DATA_LABELS=false
EVOLUTION_DATABASE_SAVE_DATA_HISTORIC=true

# cache Redis
EVOLUTION_CACHE_REDIS_ENABLED=true
EVOLUTION_CACHE_REDIS_URI=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/6
EVOLUTION_CACHE_REDIS_PREFIX_KEY=evolution
EVOLUTION_CACHE_REDIS_SAVE_INSTANCES=true
EVOLUTION_CACHE_LOCAL_ENABLED=false

# WhatsApp
EVOLUTION_CONFIG_SESSION_PHONE_VERSION=2.2402.5

################################################################################
# LOG CONFIGURATIONS
################################################################################
LOG_LEVEL=info
LOG_FORMAT=json
